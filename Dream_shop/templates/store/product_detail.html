{% extends 'base.html' %}
{% load static %}

{% block content %}
<!-- Affichage des détails du produit -->
<div class="product-card-detail">
    <div class="product-image-detail">
        <!-- Image principale du produit -->
        <img id="product-main-image" src="{{ single_product.images.url }}" alt="Image de l'article">
        <div class="product-thumbnails">
            <!-- Vignettes d'images supplémentaires du produit -->
            {% if single_product.second_image %}
            <img class="product-thumbnail" src="{{ single_product.second_image.url }}" alt="Image 2 de l'article">
            {% endif %}
            {% if single_product.third_image %}
            <img class="product-thumbnail" src="{{ single_product.third_image.url }}" alt="Image 3 de l'article">
            {% endif %}
            {% if single_product.fourth_image %}
            <img class="product-thumbnail" src="{{ single_product.fourth_image.url }}" alt="Image 4 de l'article">
            {% endif %}
            {% if single_product.fifth_image %}
            <img class="product-thumbnail" src="{{ single_product.fifth_image.url }}" alt="Image 5 de l'article">
            {% endif %}
        </div>
    </div>


    <div class="product-info-detail">
        <!-- Formulaire pour ajouter le produit au panier -->
        <form action="{% url 'add_cart' single_product.id %}" method="POST">
            {% csrf_token %}
        <h2>{{ single_product.title_online}}</h2><!-- Titre du produit -->
        <h3>{{ single_product.price|floatformat:2 }}</h3><!-- Prix du produit -->
        <p>{{ single_product.description }}</p><!-- Description du produit -->
        <div class="select-quantity-detail">
            <div>
                <label for="product-size">Taille:</label>
                <select id="product-size" name="size" required>
                    <option value="" disabled selected>Choisir la taille</option>
                    {% for i in single_product.variation_set.sizes %}
                    <option value="{{ i.variation_value | lower }}">{{ i.variation_value | capfirst }}</option>
                    {% endfor %}
                </select>
            </div>
            <div>
                <label for="product-color">Couleur:</label>
                <select id="product-color" name="color" required>
                    <option value="" disabled selected>Choisir la couleur</option>
                    {% for i in single_product.variation_set.colors %}
                    <option value="{{ i.variation_value | lower }}">{{ i.variation_value | capfirst }}</option>
                    {% endfor %}
                </select>
            </div>
        </div>
        {% if single_product.stock <= 0 %}
        <!-- Affiche un message si le stock est épuisé -->
        <h5 class="text-danger">Rupture De Stock</h5>
            {% else %}
                <a class="add-to-cart-link">
                    <button type="submit" class="btn-detail">Ajouter au panier<i class="fas fa-shopping-cart"></i></button>
                </a>
        {% endif %}
    </form>
    </div>
</div>



<!-- Changement d'image au clic sur les vignettes -->
<script>
    window.addEventListener('load', function () {
        var thumbnails = document.getElementsByClassName('product-thumbnail');

        for (var i = 0; i < thumbnails.length; i++) {
            thumbnails[i].addEventListener('click', function () {
                var mainImage = document.querySelector('#product-main-image');
                var mainImageUrl = mainImage.src;

                var thumbnailImageUrl = this.src;

                mainImage.src = thumbnailImageUrl;
                this.src = mainImageUrl;
            });
        }
    });
</script>

{% endblock %}